<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GROVE | Cut Slip</title>

<style>
:root{
  --bg:#070707;
  --line:rgba(255,255,255,.14);
  --text:#f5f5f5;
  --muted:rgba(255,255,255,.65);
  --red:#ef2a1f;
  --radius:22px;
  --shadow:0 20px 60px rgba(0,0,0,.55);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color:var(--text);
  background:var(--bg);
  min-height:100vh;
  padding:24px;
  overflow-x:hidden;
}
.bgGlow{
  position:fixed; inset:-40%;
  background:
    radial-gradient(900px 500px at 15% 15%, rgba(239,42,31,.14), transparent 60%),
    radial-gradient(700px 450px at 85% 35%, rgba(255,255,255,.05), transparent 60%);
  filter: blur(14px);
  pointer-events:none;
  z-index:-3;
}
.wrap{max-width:980px;margin:0 auto;position:relative}
.wm-center{
  position:absolute; left:50%; top:55%;
  width:78%; max-width:820px;
  transform: translate(-50%, -50%);
  pointer-events:none; z-index:-1;
  animation: zoomBreath 16s ease-in-out infinite;
}
.wm-center img{
  width:100%;
  opacity:.08;
  filter: grayscale(100%) contrast(115%);
  position:relative; z-index:2;
}
.wm-glow{
  position:absolute; inset:-22%;
  background: radial-gradient(circle at center, rgba(255,255,255,.25), rgba(255,255,255,0) 65%);
  filter: blur(14px); z-index:1;
}
@keyframes zoomBreath{
  0%{transform:translate(-50%,-50%) scale(1)}
  50%{transform:translate(-50%,-50%) scale(1.05)}
  100%{transform:translate(-50%,-50%) scale(1)}
}

.topbar{
  display:flex;justify-content:space-between;align-items:center;
  gap:12px; flex-wrap:wrap;
  margin-bottom:16px;
}
.logoPlate{
  background:#fff;
  padding:10px 14px;
  border-radius:16px;
  box-shadow:0 12px 30px rgba(0,0,0,.35);
  display:inline-flex;
  align-items:center;
  gap:10px;
}
.logoPlate img{height:46px;display:block}
.pill{
  font-size:12px;font-weight:900;color:rgba(255,255,255,.75);
  border:1px solid rgba(255,255,255,.14);
  padding:9px 12px;border-radius:999px;
  background:rgba(255,255,255,.03);
  display:flex;align-items:center;gap:10px;
}
.dot{width:9px;height:9px;border-radius:50%;background:var(--red);box-shadow:0 0 0 5px rgba(239,42,31,.18);}
.actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end}
.btn{
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.04);
  color:#fff;
  font-weight:900;
  padding:10px 12px;
  border-radius:14px;
  cursor:pointer;
}
.btn.primary{
  border:none;
  background:linear-gradient(180deg,#ff3b30,var(--red));
}

.card{
  border:1px solid var(--line);
  border-radius:var(--radius);
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  box-shadow:var(--shadow);
  overflow:hidden;
  position:relative;
  z-index:1;
}
.head{
  padding:18px 22px;
  border-bottom:1px solid var(--line);
  background:rgba(0,0,0,.22);
}
h1{margin:0;font-size:24px}
.sub{margin-top:6px;color:var(--muted);line-height:1.55}
.body{padding:18px 22px 22px}

.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
@media(max-width:820px){.grid{grid-template-columns:1fr}.wm-center{display:none}}

.panel{
  border:1px solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.18);
  border-radius:18px;
  padding:14px;
}
.panelTitle{
  font-weight:1000;
  margin-bottom:10px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}
.bigCut{
  font-size:44px;
  font-weight:1000;
  letter-spacing:.3px;
  margin-top:6px;
}
.small{color:rgba(255,255,255,.66);font-size:12px;line-height:1.45}
.kv{
  display:grid;
  grid-template-columns: 120px 1fr;
  gap:8px 12px;
  font-size:13px;
}
.kv b{color:rgba(255,255,255,.85)}
.tag{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:7px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.03);
  color:rgba(255,255,255,.75);
  font-size:12px;
  font-weight:900;
}
.hr{
  border:none;
  border-top:1px solid rgba(255,255,255,.10);
  margin:12px 0;
}
.noteBox{
  border:1px dashed rgba(255,255,255,.22);
  border-radius:16px;
  padding:12px;
  min-height:54px;
  color:rgba(255,255,255,.80);
  background:rgba(255,255,255,.02);
  white-space:pre-wrap;
}
.footer{
  border-top:1px solid rgba(255,255,255,.10);
  padding:14px 22px;
  font-size:12px;
  color:rgba(255,255,255,.45);
  display:flex;
  justify-content:space-between;
  background:rgba(0,0,0,.18);
  gap:10px;
  flex-wrap:wrap;
}
.badgeRed{
  display:inline-block;
  padding:6px 10px;
  border-radius:999px;
  background:rgba(239,42,31,.16);
  border:1px solid rgba(239,42,31,.35);
  font-size:12px;
  font-weight:1000;
}

/* PRINT */
@media print{
  body{background:#fff;color:#000;padding:0}
  .bgGlow, .wm-center, .topbar, .actions, .pill {display:none !important;}
  .wrap{max-width:none}
  .card{border:1px solid #ddd;box-shadow:none;background:#fff}
  .head{background:#fff;color:#000}
  .sub{color:#333}
  .panel{background:#fff;border:1px solid #ddd}
  .tag{border:1px solid #ddd;background:#fff;color:#111}
  .small{color:#333}
  .kv b{color:#000}
  .noteBox{border:1px dashed #bbb;background:#fff;color:#111}
  .footer{background:#fff;color:#333;border-top:1px solid #ddd}
}
</style>
</head>

<body>
<div class="bgGlow"></div>

<div class="wrap">
  <div class="wm-center" aria-hidden="true">
    <div class="wm-glow"></div>
    <img src="grove-logo.png" alt="">
  </div>

  <div class="topbar">
    <div class="logoPlate">
      <img src="grove-logo.png" alt="GROVE">
    </div>
    <div class="actions">
      <div class="pill"><span class="dot"></span>Cut Slip • MS Pipes</div>
      <button class="btn" onclick="copySlip()">Copy Slip</button>
      <button class="btn primary" onclick="window.print()">Print</button>
    </div>
  </div>

  <div class="card">
    <div class="head">
      <h1>GROVE Cut Slip</h1>
      <div class="sub">
        Cut Length = CTC − (Offset A + Offset B + Weld Gaps).
        <span class="badgeRed">Weld gap = 3mm for all fittings except Flange</span>
      </div>
    </div>

    <div class="body">
      <div class="grid">
        <div class="panel">
          <div class="panelTitle">
            <span>Cut Length</span>
            <span class="tag" id="timeTag">—</span>
          </div>
          <div class="bigCut" id="cut">—</div>
          <div class="small" id="formula">—</div>

          <div class="hr"></div>

          <div class="kv">
            <b>Pipe size</b><div id="size">—</div>
            <b>ID / OD</b><div id="idod">—</div>
            <b>CTC</b><div id="ctc">—</div>
          </div>

          <div class="hr"></div>

          <div class="small"><b>Notes</b></div>
          <div class="noteBox" id="notes">—</div>
        </div>

        <div class="panel">
          <div class="panelTitle">
            <span>Ends & Offsets</span>
            <span class="tag">Check before cut</span>
          </div>

          <div class="kv">
            <b>End A</b><div id="endA">—</div>
            <b>Offset A</b><div id="offA">—</div>
            <b>Weld A</b><div id="wA">—</div>
            <b>End B</b><div id="endB">—</div>
            <b>Offset B</b><div id="offB">—</div>
            <b>Weld B</b><div id="wB">—</div>
          </div>

          <div class="hr"></div>

          <div class="small" id="warning" style="display:none;border:1px solid rgba(239,42,31,.40);background:rgba(239,42,31,.10);padding:10px 12px;border-radius:14px;">
            ⚠️ Short Radius (SR) on large sizes — confirm drawing/spec before cutting.
          </div>

          <div class="small" style="margin-top:10px;">
            <b>Tip:</b> If this slip looks wrong, go back and re-check pipe size + fitting type (SR/LR/45/Tee/Flange).
          </div>
        </div>
      </div>
    </div>

    <div class="footer">
      <div>© GROVE Services Ltd. • Internal use only</div>
      <div id="ref">—</div>
    </div>
  </div>
</div>

<script>
/* read payload saved by calculator.html */
const raw = sessionStorage.getItem("grove_slip_payload");
let data = null;
try { data = raw ? JSON.parse(raw) : null; } catch(e){}

function fmtDate(iso){
  try{
    const d = new Date(iso);
    return d.toLocaleString();
  }catch(e){ return "—"; }
}

function set(id, val){
  const el = document.getElementById(id);
  el.textContent = (val === undefined || val === null || val === "" ? "—" : String(val));
}

function show(id){ document.getElementById(id).style.display="block"; }

function build(){
  if(!data){
    set("cut","—");
    set("formula","No slip data found. Go back to calculator and enter CTC.");
    set("ref","Open calculator first.");
    set("notes","—");
    return;
  }

  set("cut", `${data.cut} mm`);
  set("size", `${data.s}`);
  set("idod", `${data.i} / ${data.o} mm`);
  set("ctc", `${data.c} mm`);
  set("endA", data.a);
  set("endB", data.b);
  set("offA", `${data.oa} mm`);
  set("offB", `${data.ob} mm`);
  set("wA", data.wa ? `${data.wa} mm` : `0 mm (Flange)`);
  set("wB", data.wb ? `${data.wb} mm` : `0 mm (Flange)`);

  const f = `CTC ${data.c} − (A ${data.oa}${data.wa?`+${data.wa}`:""} + B ${data.ob}${data.wb?`+${data.wb}`:""})`;
  set("formula", f);

  set("notes", data.n ? data.n : "—");
  set("timeTag", fmtDate(data.t));

  set("ref", `Ref: ${data.s} • ${data.cut}mm`);

  /* SR warning on large sizes */
  const inch = (() => {
    const s = (data.s||"").replace('"','').trim();
    if (s.includes(' ')) {
      const [w, frac] = s.split(' ');
      const [n,d] = frac.split('/');
      return Number(w) + (Number(n)/Number(d));
    }
    if (s.includes('/')) {
      const [n,d] = s.split('/');
      return Number(n)/Number(d);
    }
    return Number(s);
  })();

  const isSR = (String(data.a||"").toLowerCase().includes("short radius") ||
                String(data.b||"").toLowerCase().includes("short radius"));

  if(inch >= 8 && isSR){
    show("warning");
  }
}
build();

/* Copy slip text (Safari friendly) */
function copyTextSafe(text){
  try{
    const ta=document.createElement("textarea");
    ta.value=text;
    document.body.appendChild(ta);
    ta.select();
    document.execCommand("copy");
    document.body.removeChild(ta);
    return true;
  }catch(e){ return false; }
}

function copySlip(){
  if(!data) return;
  const t =
`GROVE CUT SLIP
CUT: ${data.cut} mm
CTC: ${data.c} mm
SIZE: ${data.s} (ID ${data.i}mm, OD ${data.o}mm)

END A: ${data.a}
OFFSET A: ${data.oa} mm
WELD A: ${data.wa ? data.wa + " mm" : "0 mm (Flange)"}

END B: ${data.b}
OFFSET B: ${data.ob} mm
WELD B: ${data.wb ? data.wb + " mm" : "0 mm (Flange)"}

NOTES: ${data.n ? data.n : "—"}`;
  copyTextSafe(t);
}
</script>

</body>
</html>
