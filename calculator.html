<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GROVE | MS Pipe Cut Length Calculator</title>

  <style>
    :root{
      --bg:#070707;
      --line:rgba(255,255,255,.12);
      --text:#f5f5f5;
      --muted:rgba(255,255,255,.65);
      --red:#ef2a1f;
      --radius:22px;
      --shadow:0 20px 60px rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color:var(--text);
      background:var(--bg);
      min-height:100vh;
      padding:24px;
      overflow-x:hidden;
    }

    /* background glow for continuity */
    .bgGlow{
      position:fixed; inset:-40%;
      background:
        radial-gradient(900px 500px at 15% 15%, rgba(239,42,31,.16), transparent 60%),
        radial-gradient(700px 450px at 85% 35%, rgba(255,255,255,.06), transparent 60%);
      filter: blur(14px);
      animation: float 12s ease-in-out infinite alternate;
      pointer-events:none;
      z-index:-1;
    }
    @keyframes float{
      from{ transform: translate(-1%, -1%) }
      to  { transform: translate( 1%,  1%) }
    }

    .wrap{max-width:1000px;margin:0 auto;}

    /* header */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:16px;
    }
    .logoPlate{
      background:#fff;
      padding:10px 14px;
      border-radius:16px;
      box-shadow:0 12px 30px rgba(0,0,0,.35);
      display:flex;
      align-items:center;
      gap:10px;
    }
    .logoPlate img{height:46px;width:auto;display:block;}

    .topRight{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .pill{
      font-size:12px;
      font-weight:800;
      color:var(--muted);
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:9px 12px;
      border-radius:999px;
      white-space:nowrap;
      display:flex;
      align-items:center;
      gap:10px;
    }
    .dot{
      width:9px;height:9px;border-radius:50%;
      background:var(--red);
      box-shadow:0 0 0 5px rgba(239,42,31,.18);
      animation:pulse 1.8s ease infinite;
    }
    @keyframes pulse{ 50%{ transform:scale(1.1);} }

    .version{
      font-size:11px;
      font-weight:700;
      color:rgba(255,255,255,.55);
      padding:6px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.03);
      white-space:nowrap;
    }
    .btnSmall{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--text);
      font-weight:900;
      padding:9px 12px;
      border-radius:999px;
      cursor:pointer;
    }

    /* card */
    .card{
      border:1px solid var(--line);
      border-radius:var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    .cardHead{
      padding:18px 22px;
      border-bottom:1px solid var(--line);
      background:rgba(0,0,0,.22);
    }
    h1{margin:0 0 6px;font-size:24px;}
    .sub{margin:0;color:var(--muted);line-height:1.6;}

    .content{
      padding:18px 22px 22px;
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:16px;
    }
    @media(max-width:900px){
      .content{grid-template-columns:1fr}
    }

    /* step blocks */
    .block{
      border:1px solid var(--line);
      border-radius:18px;
      background:rgba(0,0,0,.20);
      padding:14px;
    }
    .blockTitle{
      display:flex;
      align-items:center;
      gap:10px;
      font-weight:900;
      margin-bottom:10px;
    }
    .stepNum{
      width:28px;height:28px;border-radius:10px;
      display:flex;align-items:center;justify-content:center;
      background:rgba(239,42,31,.18);
      border:1px solid rgba(239,42,31,.35);
      color:#fff;
      font-weight:900;
      font-size:13px;
    }
    label{
      display:block;
      font-size:12px;
      font-weight:900;
      color:rgba(255,255,255,.78);
      margin:10px 0 6px;
    }
    select,input{
      width:100%;
      padding:14px;
      border-radius:14px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.05);
      color:var(--text);
      font-size:15px;
      outline:none;
    }
    select option{background:#111;color:#fff;}

    .row2{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
    }
    @media(max-width:700px){
      .row2{grid-template-columns:1fr}
    }

    /* actions + result */
    .actions{
      display:flex;
      gap:10px;
      margin-top:12px;
      flex-wrap:wrap;
    }
    .btnPrimary{
      border:none;
      cursor:pointer;
      font-weight:900;
      padding:13px 14px;
      border-radius:14px;
      background: linear-gradient(180deg, #ff3b30, var(--red));
      color:#fff;
      box-shadow:0 16px 30px rgba(239,42,31,.22);
      flex:1;
      min-width:180px;
    }
    .btnGhost{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      color:var(--text);
      font-weight:900;
      padding:13px 14px;
      border-radius:14px;
      cursor:pointer;
      flex:1;
      min-width:140px;
    }

    .resultCard{
      border:1px solid rgba(239,42,31,.35);
      background: rgba(239,42,31,.08);
      border-radius:18px;
      padding:16px;
    }
    .resultLabel{
      color:rgba(255,255,255,.7);
      font-weight:900;
      font-size:12px;
      letter-spacing:.3px;
    }
    .resultValue{
      margin-top:6px;
      font-size:34px;
      font-weight:1000;
      line-height:1.1;
    }
    .resultMeta{
      margin-top:10px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      color:rgba(255,255,255,.7);
      font-size:12px;
    }
    .metaPill{
      border:1px solid var(--line);
      background:rgba(255,255,255,.03);
      padding:7px 10px;
      border-radius:999px;
    }

    .help{
      margin-top:10px;
      color:rgba(255,255,255,.55);
      font-size:12px;
      line-height:1.5;
    }

    .footer{
      border-top:1px solid var(--line);
      padding:14px 22px;
      font-size:12px;
      color:rgba(255,255,255,.45);
      display:flex;
      justify-content:space-between;
      background: rgba(0,0,0,.18);
    }
  </style>
</head>

<body>
  <div class="bgGlow"></div>

  <script>
    // Access gate
    if (sessionStorage.getItem("cutcalc_ok") !== "1") {
      window.location.href = "index.html";
    }
    function logout(){
      sessionStorage.removeItem("cutcalc_ok");
      window.location.href = "index.html";
    }
  </script>

  <div class="wrap">
    <div class="topbar">
      <div class="logoPlate">
        <img src="grove-logo.png" alt="GROVE Services Ltd">
      </div>

      <div class="topRight">
        <div class="pill"><span class="dot"></span>MS Pipes • Calculator</div>
        <div class="version">Standard v1.0 • Sep 2025</div>
        <button class="btnSmall" onclick="window.location.href='pipe-type.html'">← Pipe Type</button>
        <button class="btnSmall" onclick="logout()">Exit</button>
      </div>
    </div>

    <div class="card">
      <div class="cardHead">
        <h1>Pipe Cut Length Calculator</h1>
        <p class="sub">Select fitting types, enter centre-to-centre, and get the exact cut length using the standard MS offset table.</p>
      </div>

      <div class="content">
        <!-- LEFT: Steps -->
        <div class="block">
          <div class="blockTitle"><div class="stepNum">1</div> Pipe size</div>

          <label>Pipe Size</label>
          <select id="size"></select>

          <div class="help">Pipe sizes show both inch + mm (ID & OD) to avoid mistakes on site.</div>

          <hr style="border:none;border-top:1px solid rgba(255,255,255,.10);margin:14px 0;">

          <div class="blockTitle"><div class="stepNum">2</div> Select fittings</div>

          <div class="row2">
            <div>
              <label>End A</label>
              <select id="endA"></select>
            </div>
            <div>
              <label>End B</label>
              <select id="endB"></select>
            </div>
          </div>

          <hr style="border:none;border-top:1px solid rgba(255,255,255,.10);margin:14px 0;">

          <div class="blockTitle"><div class="stepNum">3</div> Measurement</div>

          <label>Centre-to-centre (mm)</label>
          <input id="ctc" type="number" inputmode="decimal" placeholder="e.g. 1200">

          <div class="actions">
            <button class="btnPrimary" onclick="calculate()">Calculate</button>
            <button class="btnGhost" onclick="resetAll()">Reset</button>
          </div>

          <div class="help">
            Formula: <b>Cut Length = CTC − (Offset A + Offset B)</b>
          </div>
        </div>

        <!-- RIGHT: Result -->
        <div class="block">
          <div class="blockTitle"><div class="stepNum">✓</div> Result</div>

          <div id="resultCard" class="resultCard" style="display:none">
            <div class="resultLabel">Cut length</div>
            <div id="cut" class="resultValue">—</div>
            <div id="formula" class="help"></div>

            <div id="meta" class="resultMeta"></div>
          </div>

          <div id="resultEmpty" class="help">
            Select options and enter CTC, then press <b>Calculate</b>.
          </div>
        </div>
      </div>

      <div class="footer">
        <div>© GROVE Services Ltd.</div>
        <div>Internal use only</div>
      </div>
    </div>
  </div>

<script>
  // Offset data (same as your working version)
  const DATA = {
    '1/2"': {id:15, od:21.3, flange:null, elbow:38, teeD:25, teeE:50},
    '3/4"': {id:20, od:26.9, flange:null, elbow:38, teeD:29, teeE:58},
    '1"': {id:25, od:33.7, flange:null, elbow:38, teeD:38, teeE:76},
    '1 1/4"': {id:32, od:42.4, flange:null, elbow:48, teeD:48, teeE:96},
    '1 1/2"': {id:40, od:48.3, flange:null, elbow:57, teeD:57, teeE:114},
    '2"': {id:50, od:60.3, flange:null, elbow:76, teeD:64, teeE:128},
    '2 1/2"': {id:65, od:76.1, flange:20, elbow:95, teeD:76, teeE:152},
    '3"': {id:80, od:88.9, flange:20, elbow:114, teeD:86, teeE:172},
    '4"': {id:100, od:114.3, flange:20, elbow:152, teeD:105, teeE:210},
    '5"': {id:125, od:139.7, flange:20, elbow:190, teeD:124, teeE:248},
    '6"': {id:150, od:168.3, flange:20, elbow:229, teeD:143, teeE:286},
    '8"': {id:200, od:219.1, flange:25, elbow:305, teeD:178, teeE:356},
    '10"': {id:250, od:273, flange:25, elbow:381, teeD:216, teeE:432},
    '12"': {id:300, od:323.9, flange:25, elbow:457, teeD:254, teeE:508},
    '14"': {id:350, od:355.6, flange:25, elbow:533, teeD:279, teeE:558},
    '16"': {id:400, od:406.4, flange:25, elbow:610, teeD:305, teeE:610},
    '18"': {id:450, od:457, flange:25, elbow:686, teeD:343, teeE:686},
    '20"': {id:500, od:508, flange:25, elbow:762, teeD:381, teeE:762}
  };

  const FITTINGS = [
    {key:"flange", label:"Flange (A)"},
    {key:"elbow", label:"90° Elbow (C)"},
    {key:"teeD", label:"Tee (D)"},
    {key:"teeE", label:"Tee (E)"}
  ];

  const sizeSel = document.getElementById("size");
  const endA = document.getElementById("endA");
  const endB = document.getElementById("endB");

  function loadSizes(){
    Object.keys(DATA).forEach(sz=>{
      const r = DATA[sz];
      const o = document.createElement("option");
      o.value = sz;
      // show inch + mm clearly
      o.textContent = `${sz}  •  ID ${r.id}mm  •  OD ${r.od}mm`;
      sizeSel.appendChild(o);
    });
    sizeSel.value = '2"';
  }

  function loadEnds(){
    [endA, endB].forEach(sel=>{
      FITTINGS.forEach(f=>{
        const o = document.createElement("option");
        o.value = f.key;
        o.textContent = f.label;
        sel.appendChild(o);
      });
    });
    endA.value = "elbow";
    endB.value = "elbow";
  }

  loadSizes();
  loadEnds();

  function showResult(cut, a, b, size){
    const row = DATA[size];

    document.getElementById("resultEmpty").style.display = "none";
    document.getElementById("resultCard").style.display = "block";

    document.getElementById("cut").innerText = `${cut} mm`;
    document.getElementById("formula").innerText = `CTC − (${a} + ${b})`;

    document.getElementById("meta").innerHTML = `
      <div class="metaPill"><b>Size:</b> ${size}</div>
      <div class="metaPill"><b>ID:</b> ${row.id}mm</div>
      <div class="metaPill"><b>OD:</b> ${row.od}mm</div>
      <div class="metaPill"><b>End A:</b> ${endA.options[endA.selectedIndex].text}</div>
      <div class="metaPill"><b>End B:</b> ${endB.options[endB.selectedIndex].text}</div>
    `;
  }

  function calculate(){
    const size = sizeSel.value;
    const ctc = Number(document.getElementById("ctc").value);

    if(!ctc || ctc <= 0){
      alert("Enter a valid centre-to-centre value in mm.");
      return;
    }

    const row = DATA[size];
    const a = row[endA.value];
    const b = row[endB.value];

    if(a === null || b === null){
      alert("Flange offset not defined for this size in the table.");
      return;
    }

    const cut = ctc - (a + b);
    showResult(cut, a, b, size);
  }

  function resetAll(){
    sizeSel.value = '2"';
    endA.value = "elbow";
    endB.value = "elbow";
    document.getElementById("ctc").value = "";

    document.getElementById("resultCard").style.display = "none";
    document.getElementById("resultEmpty").style.display = "block";
  }
</script>

</body>
</html>
