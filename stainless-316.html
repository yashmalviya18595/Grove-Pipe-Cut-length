<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GROVE | Stainless 316 S10 Cut Length</title>

<style>
:root{
  --bg:#070707;
  --line:rgba(255,255,255,.12);
  --text:#f5f5f5;
  --muted:rgba(255,255,255,.65);
  --red:#ef2a1f;
  --radius:22px;
  --shadow:0 22px 70px rgba(0,0,0,.60);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
  color:var(--text);
  background:var(--bg);
  overflow-x:hidden;
}
.bgGlow{
  position:fixed; inset:-40%;
  background:
    radial-gradient(900px 520px at 18% 16%, rgba(239,42,31,.14), transparent 60%),
    radial-gradient(700px 460px at 84% 34%, rgba(255,255,255,.05), transparent 60%);
  filter: blur(14px);
  pointer-events:none;
  z-index:-3;
}
.wm-center{
  position:fixed;
  left:50%;
  top:56%;
  width:min(980px, 92vw);
  transform: translate(-50%, -50%);
  pointer-events:none;
  z-index:-2;
  animation: zoomBreath 16s ease-in-out infinite;
}
.wm-center img{
  width:100%;
  opacity:.10;
  filter: grayscale(100%) contrast(115%);
}
.wm-glow{
  position:absolute; inset:-22%;
  background: radial-gradient(circle at center, rgba(255,255,255,.25), rgba(255,255,255,0) 65%);
  filter: blur(16px);
  z-index:-1;
}
@keyframes zoomBreath{
  0%{transform:translate(-50%,-50%) scale(1)}
  50%{transform:translate(-50%,-50%) scale(1.05)}
  100%{transform:translate(-50%,-50%) scale(1)}
}
.stage{
  min-height:100vh;
  display:grid;
  grid-template-rows:auto 1fr auto;
  padding:22px;
}
.topbar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  flex-wrap:wrap;
}
.logoLink{display:inline-flex; align-items:center; text-decoration:none;}
.logoPlate{
  background:#fff;
  padding:10px 14px;
  border-radius:16px;
  box-shadow:0 12px 30px rgba(0,0,0,.35);
  transition: transform 160ms ease, box-shadow 160ms ease;
  cursor:pointer;
}
.logoPlate:hover{transform: translateY(-1px); box-shadow:0 16px 38px rgba(0,0,0,.42);}
.logoPlate:active{transform: translateY(0px) scale(.99);}
.logoPlate img{height:46px; display:block;}
.pill{
  font-size:12px;
  font-weight:900;
  color:rgba(255,255,255,.75);
  border:1px solid var(--line);
  padding:9px 12px;
  border-radius:999px;
  background:rgba(255,255,255,.03);
  display:flex;
  align-items:center;
  gap:10px;
}
.dot{width:9px;height:9px;border-radius:50%;background:var(--red);box-shadow:0 0 0 5px rgba(239,42,31,.18);}
.center{display:grid; place-items:center; padding:10px 0;}
.card{
  width:min(1100px, 100%);
  border:1px solid var(--line);
  border-radius:var(--radius);
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  box-shadow:var(--shadow);
  overflow:hidden;
}
.head{
  padding:18px 22px;
  border-bottom:1px solid var(--line);
  background:rgba(0,0,0,.22);
}
h1{margin:0;font-size:26px;font-weight:1000}
.sub{margin-top:6px;color:var(--muted);line-height:1.55}
.body{padding:18px 22px 22px}
.grid{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
@media(max-width:900px){ .grid{grid-template-columns:1fr;} }
.field{
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.16);
  border-radius:18px;
  padding:14px;
}
.label{font-size:12px;font-weight:1000;color:rgba(255,255,255,.75);margin-bottom:8px;}
select, input{
  width:100%;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.05);
  color:#fff;
  padding:12px 12px;
  font-size:15px;
  outline:none;
}
.actions{
  display:grid;
  grid-template-columns:1fr 1fr 1fr;
  gap:12px;
  margin-top:14px;
}
@media(max-width:900px){ .actions{grid-template-columns:1fr;} }
.btn{
  border:1px solid rgba(255,255,255,.14);
  background:rgba(255,255,255,.04);
  color:#fff;
  font-weight:1000;
  padding:14px 16px;
  border-radius:16px;
  cursor:pointer;
  transition: transform 140ms ease, background 140ms ease;
}
.btn:hover{background:rgba(255,255,255,.06); transform: translateY(-1px);}
.btn:active{transform: translateY(0px) scale(.99);}
.btn.primary{border:none; background:linear-gradient(180deg,#ff3b30,var(--red));}
.result{
  margin-top:14px;
  border:1px solid rgba(255,255,255,.14);
  background:rgba(0,0,0,.18);
  border-radius:18px;
  padding:14px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:14px;
  flex-wrap:wrap;
}
.big{font-size:28px;font-weight:1100;letter-spacing:.2px;}
.small{font-size:12px;color:rgba(255,255,255,.62);line-height:1.5;}
.footer{text-align:center;color:rgba(255,255,255,.40);font-size:12px;padding-top:10px;}

/* Premium fade-in transition */
.page{
  opacity:0;
  transform: translateY(6px);
  transition: opacity 340ms ease, transform 340ms ease, filter 340ms ease;
  will-change: opacity, transform, filter;
}
.page.is-ready{ opacity:1; transform:none; filter:none; }
</style>
</head>

<body>
<div class="bgGlow"></div>

<div class="wm-center" aria-hidden="true">
  <div class="wm-glow"></div>
  <img src="grove-logo.png" alt="">
</div>

<script>
if (sessionStorage.getItem("cutcalc_ok") !== "1") {
  window.location.href = "index.html";
}
</script>

<div class="stage page" id="page">
  <div class="topbar">
    <a class="logoLink" href="pipe-type.html" title="Back to Pipe Type">
      <div class="logoPlate"><img src="grove-logo.png" alt="GROVE"></div>
    </a>
    <div class="pill"><span class="dot"></span>Stainless 316 S10</div>
  </div>

  <div class="center">
    <div class="card">
      <div class="head">
        <h1>Stainless 316 (Schedule 10) Calculator</h1>
        <div class="sub">Select both end fittings + enter centre-to-centre. Weld gap: <b>3mm</b> applies to all fittings except flange.</div>
      </div>

      <div class="body">
        <div class="grid">
          <div class="field">
            <div class="label">Pipe Size</div>
            <select id="pipeSize"></select>
          </div>

          <div class="field">
            <div class="label">Centre-to-Centre (mm)</div>
            <input id="ctc" type="number" inputmode="decimal" placeholder="e.g. 1200" />
          </div>

          <div class="field">
            <div class="label">Fitting (End A)</div>
            <select id="fitA"></select>
          </div>

          <div class="field">
            <div class="label">Fitting (End B)</div>
            <select id="fitB"></select>
          </div>
        </div>

        <div class="result">
          <div>
            <div class="small">Calculated Cut Length</div>
            <div class="big"><span id="cutLen">—</span> mm</div>
          </div>
          <div class="small" id="breakdown">Select size + fittings + CTC.</div>
        </div>

        <div class="actions">
          <button class="btn" onclick="copyCut()">Copy</button>
          <button class="btn" onclick="openSlip()">Open / Print Cut Slip</button>
          <button class="btn primary" onclick="resetAll()">Reset</button>
        </div>
      </div>
    </div>
  </div>

  <div class="footer">© GROVE Services Ltd. • Internal use only</div>
</div>

<script>
/* Fade in on load */
requestAnimationFrame(()=>document.getElementById("page").classList.add("is-ready"));

/* =========================================================
   ✅ IMPORTANT: PASTE YOUR EXISTING SS 316 S10 TABLE HERE
   Replace placeholder values with your full 316 S10 data.
   ========================================================= */
const DATA = {
  sizes: [
    // Example only — REPLACE with your full SS list
    // { label: '1"', dims: { flangeA: 0, elbow90LR: 0, elbow90SR: 0, elbow45: 0, teeD: 0, teeE: 0 } },
  ],
  fittings: [
    { key:"flange", label:"Flange", dimKey:"flangeA", weldGap:false },
    { key:"elbow90LR", label:"90° Elbow (LR)", dimKey:"elbow90LR", weldGap:true },
    { key:"elbow90SR", label:"90° Elbow (SR)", dimKey:"elbow90SR", weldGap:true },
    { key:"elbow45", label:"45° Elbow", dimKey:"elbow45", weldGap:true },
    { key:"teeD", label:"Tee (D)", dimKey:"teeD", weldGap:true },
    { key:"teeE", label:"Tee (E)", dimKey:"teeE", weldGap:true }
  ],
  weldGapMM: 3
};

function ensureData(){
  if(!DATA.sizes || DATA.sizes.length === 0){
    document.getElementById("cutLen").textContent = "—";
    document.getElementById("breakdown").textContent =
      "316 S10 DATA is missing. Paste your full SS table into DATA.sizes in stainless-316.html.";
    return false;
  }
  return true;
}

const els = {
  pipeSize: document.getElementById("pipeSize"),
  ctc: document.getElementById("ctc"),
  fitA: document.getElementById("fitA"),
  fitB: document.getElementById("fitB"),
  cutLen: document.getElementById("cutLen"),
  breakdown: document.getElementById("breakdown")
};

function populate(){
  els.pipeSize.innerHTML = "";
  (DATA.sizes || []).forEach((s, idx)=>{
    const opt = document.createElement("option");
    opt.value = String(idx);
    opt.textContent = s.label;
    els.pipeSize.appendChild(opt);
  });

  const fillFit = (sel)=>{
    sel.innerHTML = "";
    DATA.fittings.forEach(f=>{
      const opt = document.createElement("option");
      opt.value = f.key;
      opt.textContent = f.label;
      sel.appendChild(opt);
    });
  };
  fillFit(els.fitA);
  fillFit(els.fitB);
}

function getSelectedSize(){
  const idx = Number(els.pipeSize.value);
  return DATA.sizes[idx];
}
function getFitting(key){
  return DATA.fittings.find(f=>f.key===key);
}

function compute(){
  if(!ensureData()) return;

  const size = getSelectedSize();
  const ctc = Number(els.ctc.value);

  if(!size || !isFinite(ctc) || ctc <= 0){
    els.cutLen.textContent = "—";
    els.breakdown.textContent = "Enter a valid CTC (mm).";
    return;
  }

  const a = getFitting(els.fitA.value);
  const b = getFitting(els.fitB.value);

  const takeA = Number(size.dims[a.dimKey] ?? 0);
  const takeB = Number(size.dims[b.dimKey] ?? 0);

  const weldA = a.weldGap ? DATA.weldGapMM : 0;
  const weldB = b.weldGap ? DATA.weldGapMM : 0;

  const cut = ctc - (takeA + takeB) - (weldA + weldB);

  els.cutLen.textContent = (Math.round(cut * 10) / 10).toString();
  els.breakdown.textContent =
    `CTC ${ctc} − (A ${takeA} + B ${takeB}) − (Weld ${weldA}+${weldB}) = ${Math.round(cut*10)/10} mm`;
}

function copyCut(){
  const val = els.cutLen.textContent;
  if(!val || val === "—") return;
  navigator.clipboard.writeText(val + " mm").catch(()=>{});
}

function openSlip(){
  if(!ensureData()) return;

  const size = getSelectedSize();
  const ctc = Number(els.ctc.value);
  const fitA = getFitting(els.fitA.value);
  const fitB = getFitting(els.fitB.value);

  const takeA = Number(size.dims[fitA.dimKey] ?? 0);
  const takeB = Number(size.dims[fitB.dimKey] ?? 0);
  const weldA = fitA.weldGap ? DATA.weldGapMM : 0;
  const weldB = fitB.weldGap ? DATA.weldGapMM : 0;

  const cut = ctc - (takeA + takeB) - (weldA + weldB);

  const params = new URLSearchParams({
    material: "SS316-S10",
    size: size.label,
    ctc: String(ctc),
    endA: fitA.label,
    endB: fitB.label,
    takeA: String(takeA),
    takeB: String(takeB),
    weldA: String(weldA),
    weldB: String(weldB),
    cut: String(Math.round(cut*10)/10)
  });

  window.open("stainless-316-slip.html?" + params.toString(), "_blank");
}

function resetAll(){
  els.ctc.value = "";
  if(els.pipeSize.options.length) els.pipeSize.selectedIndex = 0;
  if(els.fitA.options.length) els.fitA.selectedIndex = 0;
  if(els.fitB.options.length) els.fitB.selectedIndex = 0;
  compute();
}

populate();
compute();

["change","input"].forEach(evt=>{
  els.pipeSize.addEventListener(evt, compute);
  els.fitA.addEventListener(evt, compute);
  els.fitB.addEventListener(evt, compute);
  els.ctc.addEventListener(evt, compute);
});
</script>

</body>
</html>
